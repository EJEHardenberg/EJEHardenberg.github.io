<html>
  <head>
    <title>Using Chunked Encoding for Reporting in Wordpress</title>
    <meta name="description" content="Ethan Eldridge's personal website"/>
	<meta name="keywords" content="Ethan,Eldridge,Joachim,Programming"/>
	<meta charset=utf-8 />
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

    <link rel='stylesheet' href='/main.css' />
    <script src="/js/app.js"></script>
    <meta name="description" content="Personal website of Ethan Joachim Eldridge. Resume, blog, cooking, writing and more" />
    <script type="text/javascript">
     var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-43866715-1']);
      _gaq.push(['_trackPageview']);

      (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body>
  	<h1 id="huge">Ethan Joachim Eldridge: A Programmer.</h1>

<ol>
	<li><a href="/index.html">Home</a></li>
	<li><a href="https://github.com/EJEHardenberg">Github</a></li>
	<li><a href="/write">Writing</a></li>
	<li><a href="/projects">Projects</a></li>
	<li><a href="/resume">Resume</a></li>
	<li><a href="//ejehardenberg.github.io/cooking">Cooking</a></li>
</ol>



    <p>Note: Before you use the TL;DR due be sure it&#39;s appropriate to do so, see <a href="http://wordpress.stackexchange.com/questions/20192/wp-function-filter-for-modifying-http-headers">here</a></p>
<h3>The TL;DR;</h3>
<pre><code>add_action(&#39;template_redirect&#39;, &#39;add_chunked_encoding_for_reports_page_bc_load_speed&#39;);
function add_chunked_encoding_for_reports_page_bc_load_speed(){
    header(&quot;Transfer-encoding: chunked&quot;);    
}
...
flush(); //whenever you want to push a chunk out for sure</code></pre>
<h3>The Explanation</h3>
<p>So, for work I&#39;ve written a number of adminstrative pages for a client that 
involved some kind of reporting. Most of the time, the bulk of the computation 
could be done on the database side, which is where it should be (almost always).
But because the lists sometimes would show large amounts of tabular data the page can take a while to load. </p>
<p>So, to make things appear to load a bit better, I decided to switch the transfer
type to chunked instead of the default. Now, I was doing all this reporting only
on the admin area, so I actually used the <code>init</code> hook and checked <code>is_admin</code> in
my call to the action. In addition, I did <strong>not</strong> place the code into <code>functions.php</code>
like many people do. But rather it is within my own plugin&#39;s page. So only when 
users go to the reports page is the action enabled and the content served up as
chunked.</p>
<p>Note that this strategy, while WordPress specific, isn&#39;t neccesary
limited to WordPress. But also with any sort of PHP page that loads
large quantities of data and needs to do so in a chunked manner. Just be
sure to call <code>flush();</code> if you want to force out a chunk of output.</p>
<p>Also, note that some browsers (like chrome) buffer the first 256/512
bytes of output to do sniffing. So even if you chunk it, if there&#39;s not
a lot of data you might see the page load time not speed up for the
content you can see &#39;above the fold&#39;</p>

    

  
      <a class="floatleft" href=hosts-file-deployment>Hosts file and Testing deployment</a>
  

  
      <a class="floatright" href=php-wrong-date-half-hour>Incorrect Time in PHP despite Timezone</a>
  
   <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'ejehardenberg'; // required: replace example with your forum shortname
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    <div id="footer">
      <p>Copyright (c) Ethan Eldridge</p>
    </div>
  </body>
</html>