<!DOCTYPE HTML>
<html>
 <head>
  <title>
   Ethan's Tech Blog | Using Chunked Encoding for Reporting in Wordpress
  </title>
  <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
  <meta content="When writing pages that have a lot of output, it's beneficial to use Chunked Encoding rather than Content-length, this post talks about doing it for reporting screens in WordPress" name="description"/>
  <meta content="Ethan Eldridge" name="author"/>
  <meta content="WordPress,Chunked Encoding,Reporting,Performance" name="keywords"/>
  <meta content="index, follow" name="robots"/>
  <meta content="1 month" name="revisit-after"/>
  <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport"/>
  <link href="//static.ethanjoachimeldridge.info/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
  <link href="//static.ethanjoachimeldridge.info/favicon.ico" rel="icon" type="image/ico"/>
  <!-- Facebook Open Graph Tags -->
  <meta content="Ethan Eldridge | Using Chunked Encoding for Reporting in Wordpress" property="og:title"/>
  <meta content="article" property="og:type"/>
  <meta content="//static2.ethanjoachimeldridge.info/ethan.jpeg" property="og:image"/>
  <meta content="http://www.ethanjoachimeldridge.info/" property="og:url"/>
  <meta content="When writing pages that have a lot of output, it's beneficial to use Chunked Encoding rather than Content-length, this post talks about doing it for reporting screens in WordPress" property="og:description"/>
  <!-- Twitter Card Tags -->
  <meta content="summary" name="twitter:card"/>
  <meta content="Ethan Eldridge | Using Chunked Encoding for Reporting in Wordpress" name="twitter:title"/>
  <meta content="When writing pages that have a lot of output, it's beneficial to use Chunked Encoding rather than Content-length, this post talks about doing it for reporting screens in WordPress" name="twitter:description"/>
  <meta content="//static2.ethanjoachimeldridge.info/ethan.jpeg" name="twitter:image"/>
  <!-- Core CSS Scripts -->
  <link href="//css.ethanjoachimeldridge.info/style.css" integrity="sha384-N5yYwPDw4cymKjw0SjwRTKGAR4pv2PWn7wUtflWwszx/tkL1rEaVQyalmX2tM3wO" rel="stylesheet"/>
  <script>
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-52103053-1', 'www.ethanjoachimeldridge.info');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
  </script>
 </head>
 <body>
  <header>
   <h1>
    Using Chunked Encoding for Reporting in Wordpress
   </h1>
  </header>
  <div id="content">
   <a href="/tech-blog">
    Back
   </a>
   <p>
    Note: Before you use the TL;DR due be sure it's appropriate to do so, see
    <a href="http://wordpress.stackexchange.com/questions/20192/wp-function-filter-for-modifying-http-headers">
     here
    </a>
   </p>
   <h3>
    The TL;DR;
   </h3>
   <pre><code>add_action('template_redirect', 'add_chunked_encoding_for_reports_page_bc_load_speed');
function add_chunked_encoding_for_reports_page_bc_load_speed(){
    header("Transfer-encoding: chunked");    
}
...
flush(); //whenever you want to push a chunk out for sure
</code></pre>
   <h3>
    The Explanation
   </h3>
   <p>
    So, for work I've written a number of adminstrative pages for a client that 
involved some kind of reporting. Most of the time, the bulk of the computation 
could be done on the database side, which is where it should be (almost always).
But because the lists sometimes would show large amounts of tabular data the page can take a while to load.
   </p>
   <p>
    So, to make things appear to load a bit better, I decided to switch the transfer
type to chunked instead of the default. Now, I was doing all this reporting only
on the admin area, so I actually used the
    <code>
     init
    </code>
    hook and checked
    <code>
     is_admin
    </code>
    in
my call to the action. In addition, I did
    <strong>
     not
    </strong>
    place the code into
    <code>
     functions.php
    </code>
    like many people do. But rather it is within my own plugin's page. So only when 
users go to the reports page is the action enabled and the content served up as
chunked.
   </p>
   <p>
    Note that this strategy, while WordPress specific, isn't neccesary
limited to WordPress. But also with any sort of PHP page that loads
large quantities of data and needs to do so in a chunked manner. Just be
sure to call
    <code>
     flush();
    </code>
    if you want to force out a chunk of output.
   </p>
   <p>
    Also, note that some browsers (like chrome) buffer the first 256/512
bytes of output to do sniffing. So even if you chunk it, if there's not
a lot of data you might see the page load time not speed up for the
content you can see 'above the fold'
   </p>
   <h3>
    Other Posts
   </h3>
   <div id="other-posts">
    <ul>
     <li>
      <a href="php-wrong-date-half-hour">
       Incorrect Time in PHP despite Timezone
      </a>
     </li>
     <li>
      <a href="hosts-file-deployment">
       Hosts file and Testing deployment
      </a>
     </li>
     <li>
      <a href="harp-and-smut">
       Harp and Smut
      </a>
     </li>
     <li>
      <a href="college-friend-chicken">
       My Cooking Recipes
      </a>
     </li>
     <li>
      <a href="varnish">
       Varnish and API Servers
      </a>
     </li>
     <li>
      <a href="post__in-returning-results-with-empty-array">
       Empty Post__in WordPress problem
      </a>
     </li>
    </ul>
   </div>
   <div id="disqus_thread">
   </div>
   <script type="text/javascript">
    var disqus_shortname = 'ejehardenberg';
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
   </script>
   <noscript>
    Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">
     comments powered by Disqus.
    </a>
   </noscript>
   <a class="dsq-brlink" href="http://disqus.com">
    <!--
-->
    comments powered by
    <span class="logo-disqus">
     Disqus
    </span>
   </a>
  </div>
  <nav>
   <ul>
    <li>
     <a href="/index">
      <img height="32px" src="//static1.ethanjoachimeldridge.info/california.jpg" width="32px"/>
      <!--
-->
      <span>
       Home
      </span>
     </a>
    </li>
    <li>
     <a href="/about">
      <img height="32px" src="//static2.ethanjoachimeldridge.info/ethan.jpeg" width="32px"/>
      <!--
-->
      <span>
       About me
      </span>
     </a>
    </li>
    <li>
     <a href="/projects">
      <img height="32px" src="//static3.ethanjoachimeldridge.info/project.png" width="32px"/>
      <!--
-->
      <span>
       Projects
      </span>
     </a>
    </li>
    <li>
     <a href="/resume">
      <img height="32px" src="//static4.ethanjoachimeldridge.info/cv.png" width="32px"/>
      <!--
-->
      <span>
       Resume
      </span>
     </a>
    </li>
    <li>
     <a href="/tech-blog">
      <img height="32px" src="//static5.ethanjoachimeldridge.info/tech-blog.png" width="32px"/>
      <!--
-->
      <span>
       Tech Blog
      </span>
     </a>
    </li>
    <li>
     <a href="/cooking">
      <img height="32px" src="//static6.ethanjoachimeldridge.info/cooking.jpg" width="32px"/>
      <!--
-->
      <span>
       Cooking
      </span>
     </a>
    </li>
    <li>
     <a href="/writing">
      <img height="32px" src="//static7.ethanjoachimeldridge.info/writing.png" width="32px"/>
      <!--
-->
      <span>
       Writing
      </span>
     </a>
    </li>
    <li>
     <a href="/contact">
      <img height="32px" src="//static.ethanjoachimeldridge.info/contact.png" width="32px"/>
      <!--
-->
      <span>
       Contact
      </span>
     </a>
    </li>
    <li>
     <a href="/writing/political">
      <img height="32px" src="//static1.ethanjoachimeldridge.info/politics.png" width="32px"/>
      <!--
-->
      <span>
       Opinion
      </span>
     </a>
    </li>
    <li>
     <a href="https://github.com/EdgeCaseBerg">
      <img height="32px" src="//static2.ethanjoachimeldridge.info/github.png" width="32px"/>
      <!--
-->
      <span>
       Github
      </span>
     </a>
    </li>
    <li>
     <a href="https://twitter.com/TheR3dLily">
      <img height="32px" src="//static3.ethanjoachimeldridge.info/twitter-bird-light-bgs.png" width="32px"/>
      <!--
-->
      <span>
       @TheR3dLily
      </span>
     </a>
    </li>
    <li>
     <a href="http://www.linkedin.com/profile/view?id=151414806">
      <img height="32px" src="//static4.ethanjoachimeldridge.info/LinkedIn_logo.png" width="32px"/>
      <!--
-->
      <span>
       LinkedIn
      </span>
     </a>
    </li>
   </ul>
  </nav>
 </body>
</html>