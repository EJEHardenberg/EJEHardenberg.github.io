<!DOCTYPE HTML>
<html>
 <head>
  <title>
   Ethan's Tech Blog | Non Empty List Form Validation in Play
  </title>
  <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
  <meta content="How to use Play's form validation package to create non-empty constraints when binding forms" name="description"/>
  <meta content="Ethan Eldridge" name="author"/>
  <meta content="empty list,play,validation,scala,form,forms,nonempty,constraint" name="keywords"/>
  <meta content="index, follow" name="robots"/>
  <meta content="1 month" name="revisit-after"/>
  <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport"/>
  <link href="//static.ethanjoachimeldridge.info/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
  <link href="//static.ethanjoachimeldridge.info/favicon.ico" rel="icon" type="image/ico"/>
  <!-- Facebook Open Graph Tags -->
  <meta content="Ethan Eldridge | Non Empty List Form Validation in Play" property="og:title"/>
  <meta content="article" property="og:type"/>
  <meta content="//static.ethanjoachimeldridge.info/ethan.jpeg" property="og:image"/>
  <meta content="http://www.ethanjoachimeldridge.info/" property="og:url"/>
  <meta content="How to use Play's form validation package to create non-empty constraints when binding forms" property="og:description"/>
  <!-- Twitter Card Tags -->
  <meta content="summary" name="twitter:card"/>
  <meta content="Ethan Eldridge | Non Empty List Form Validation in Play" name="twitter:title"/>
  <meta content="How to use Play's form validation package to create non-empty constraints when binding forms" name="twitter:description"/>
  <meta content="//static.ethanjoachimeldridge.info/ethan.jpeg" name="twitter:image"/>
  <!-- Core CSS Scripts -->
  <link href="https://fonts.googleapis.com/css?family=EB+Garamond" rel="stylesheet" type="text/css"/>
  <link crossorigin="anonymous" href="//css.ethanjoachimeldridge.info/style.css" integrity="sha384-Yk6fMSCCTCPyHYaY4h661zZEU59LSxS2pX0b+B1jG+4atCz2yx/YhiimkVlATCwk" rel="stylesheet"/>
  <script>
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-52103053-1', 'www.ethanjoachimeldridge.info');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
  </script>
 </head>
 <body>
  <header>
   <h1>
    Non Empty List Form Validation in Play
   </h1>
  </header>
  <div id="content">
   <a href="/tech-blog">
    Back
   </a>
   <h3>
    Non Empty lists validation in PlayFramework 2.3
   </h3>
   <p>
    <a href="http://playframework.com">
     Play
    </a>
    has a lot of nice features built into it. One of them is form 
validation. It does this by letting you define mappings for forms:
   </p>
   <pre><code>val myForm = Form(
    mapping(
        "somefield" -&gt; someDataType
    )
)(CaseClass.apply)(CaseClass.unapply _)
</code></pre>
   <p>
    There's
    <a href="https://www.playframework.com/documentation/2.3.x/ScalaForms">
     documentation
    </a>
    on the basic use cases, such as making sure 
text fields aren't empty when submitted, or that integer values are 
within the proper range. One thing that isn't in the provided 
constraint validations is the ability to check if a list is empty or 
not.
   </p>
   <p>
    It's not too difficult to define your own constraints, you simply need 
to create a
    <a href="https://www.playframework.com/documentation/2.3.x/api/scala/index.html#play.api.data.validation.Constraint">
     Constraint
    </a>
    of the appropriate type which has an appropriate 
method for determining whether the constraint is valid or not. The code 
performing the verification should return a
    <code>
     ValidationResult
    </code>
    ,
(specifically
    <code>
     Valid
    </code>
    or
    <code>
     Invalid
    </code>
    from the
    <code>
     play.api.data.validation
    </code>
    package). In code:
   </p>
   <pre><code>def nonEmptyList[T]: Constraint[List[T]] = Constraint[List[T]]("constraint.required") { list =&gt;
    if (list.nonEmpty) Valid else Invalid(ValidationError("error.required"))
  }
</code></pre>
   <p>
    Once you've defined your validation function it is easy to use it in 
your
    <code>
     .verifying
    </code>
    clauses in form mappings:
   </p>
   <pre><code>val myFormWitList = Form(
    mapping(
          "listItems" -&gt; list(nonEmptyText).verifying(nonEmptyList)
    )(CaseClassFormData.apply)(CaseClassFormData.unapply _)
  )
</code></pre>
   <p>
    The above would give us a form validating that the form we submitted 
looked something like this:
   </p>
   <pre><code>&lt;form&gt;
    &lt;input type="text" name="listItems[]" /&gt;
    &lt;input type="text" name="listItems[]" /&gt;
    &lt;input type="text" name="listItems[]" /&gt;
    &lt;!-- etc... --&gt;
&lt;/form&gt;
</code></pre>
   <p>
    Note that you
    <strong>
     do
    </strong>
    need the name for a repeated form element to have 
the
    <code>
     []
    </code>
    at the end or
    <em>
     Play won't recognize or bind it
    </em>
    . Putting these 
all together we have:
   </p>
   <pre><code>package validations.forms

import play.api.data.Form
import play.api.data.Forms._
import play.api.data.format.Formats._
import play.api.data.validation.{Constraint,ValidationError,Valid,Invalid}


case class MyFormData(paths: List[String])

object ExampleForm {

  def nonEmptyList[T]: Constraint[List[T]] = Constraint[List[T]]("constraint.required") { o =&gt;
    if (o.nonEmpty) Valid else Invalid(ValidationError("error.required"))
  }

  val exampleForm = Form(
    mapping(
      "items" -&gt; list(nonEmptyText).verifying(nonEmptyList)
    )(MyFormData.apply)(MyFormData.unapply _)
  )
}
</code></pre>
   <p>
    Pretty simple right? We can easily write custom constraints to support 
any logic our forms might need, verifying Enumerated values, making sure 
that we've actually submitted multiple elements to an endpoint, checking 
that the username matches some custom validation. You name it, you can 
validate it.
   </p>
   <h3>
    Other Posts
   </h3>
   <div id="other-posts">
    <ul>
     <li>
      <a href="triggering-asynchronous-jobs-play-2-3">
       Trigger Asynchronous Jobs in Play 2.3
      </a>
     </li>
     <li>
      <a href="dear-god-why">
       PHP Snippet
      </a>
     </li>
     <li>
      <a href="reverse-routing-package-controller">
       Reverse routing with non-standard controller packages in Play
      </a>
     </li>
     <li>
      <a href="shell_exec-sudo-php-apache">
       shell_exec with sudo in php
      </a>
     </li>
     <li>
      <a href="generate-conditonal-policy-awscala">
       Generate Conditional AWS Group Policies with AWScala
      </a>
     </li>
     <li>
      <a href="using-sassc-with-sbt-sass">
       Using sassc with play-sass plugin
      </a>
     </li>
    </ul>
   </div>
   <div id="disqus_thread">
   </div>
   <script type="text/javascript">
    var disqus_shortname = 'ejehardenberg';
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
   </script>
   <noscript>
    Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">
     comments powered by Disqus.
    </a>
   </noscript>
   <a class="dsq-brlink" href="http://disqus.com">
    <!--
-->
    comments powered by
    <span class="logo-disqus">
     Disqus
    </span>
   </a>
  </div>
  <nav>
   <ul>
    <li>
     <a href="/index">
      <span>
       Home
      </span>
     </a>
    </li>
    <li>
     <a href="/about">
      <span>
       About me
      </span>
     </a>
    </li>
    <li>
     <a href="/projects">
      <span>
       Projects
      </span>
     </a>
    </li>
    <li>
     <a href="/resume">
      <span>
       Resume
      </span>
     </a>
    </li>
    <li>
     <a href="/tech-blog">
      <span>
       Tech Blog
      </span>
     </a>
    </li>
    <li>
     <a href="/cooking">
      <span>
       Cooking
      </span>
     </a>
    </li>
    <li>
     <a href="/writing">
      <span>
       Writing
      </span>
     </a>
    </li>
    <li>
     <a href="/contact">
      <span>
       Contact
      </span>
     </a>
    </li>
    <li>
     <a href="/writing/political">
      <span>
       Opinion
      </span>
     </a>
    </li>
    <li>
     <a href="https://github.com/EdgeCaseBerg">
      <span>
       Github
      </span>
     </a>
    </li>
    <li>
     <a href="https://twitter.com/TheR3dLily">
      <span>
       Twitter
      </span>
     </a>
    </li>
    <li>
     <a href="http://www.linkedin.com/profile/view?id=151414806">
      <span>
       LinkedIn
      </span>
     </a>
    </li>
   </ul>
  </nav>
 </body>
</html>